<html>
	<title>Milestone</title>
	<head>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=default'></script>
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
		<style>
			h1 {
				text-align: center;
			}

			.container {
				margin: 0 auto;
				padding: 60px 20%;
			}

			figure {
				text-align: center;
			}

			img {
				display: inline-block;
			}

			body {
				font-family: 'Inter', sans-serif;
			}
		</style>
	</head>
	<body>
		<div class="container">
		<h1>Lightning Variety Simulation Project</h1>
		<div style="text-align: center;">Names: Jennifer Cao, Sonia Chacon, Claire Ding, James Ni</div>

		<br>

		Link to webpage: <a href="https://arumilla.github.io/finalprojectwebpage/">https://arumilla.github.io/finalprojectwebpage/</a>
		
		<br>

		Link to GitHub repository: <a href="https://arumilla.github.io/finalprojectwebpage/">https://arumilla.github.io/finalprojectwebpage/</a>

        <br>

		<h2>Accomplishments</h2>
		&emsp; 
		After reading through the graphics and physics literature of lightning, we realized that real-life lightning is still poorly understood. Most physically-based simulated results focus solely on path-generation via the diaelectric breakdown model (DBM), which involves solving a system of partial differential equations relating to the electric charge, fields, and potential of points in the atmosphere. However, the most up-to-date hypothesis on real-life lightning formation argues that the propogation of lightning "leaders" is not based on electric fields, but rather an accumulation of metastable oxygen molecules. Thus, because this is a computer graphics and not a physics class, we adjusted the scope of our project to come up with fast approximations for these models, so that lightning can be configured, generated, and rendered in real-time. In order to demonstrate that these approximations are valid, we also opt to add interactivity to the simulation. 
        <br><br>
        &emsp; We build off the simulation and rendering framework of Homework 4, dividing the project into the two focuses: 1) fast approximations, and 2) interactivity. 1) focuses on implementing variations on 2 existing models for physically-based lightning, with options for potentially a 3rd. 2) focuses on adding GUI elements and shaders for the interactivity and real-time rendering aspect of the project.

		<h3>Lightning Path Simulation</h3>
		<p>
			<!-- &emsp; 
			3D lightning effects are typically non-physically grounded, and focus on only creating a visually believable replica of lightning for special effects. Our main focus will be implementing the algorithm for the path the lightning takes using energy minimization principles from physics. To make the simulation of particles computationally efficient, we will use Monte-Carlo sampling at each step. 		
            <br> -->

			<h4>A fast approximation to the DBM</h4>

            One path algorithm we implemented is based off a fast approximation to the DBM refernced in this paper (https://doi.org/10.1002/cav.1760). This algorithm calculates the approximate probability distribution of potentials based on the DBM, for boundary cells around the current lighting path, and chooses the next candidate cell based on the distribution. As the lightning path grows, so does the number of boundary cells. To speed up the simulation, we vectorized the probability computation and added additional parameters to cap the number of boundary cells to a certain number by removing earlier boundary cells with low probability of sampling. Additional parameters \(n\) and \(p\) affect the amount of branching that occurs. In general, higher values of \(n\) and \(p\) correlate to less branching.
			<br><br>
			Natural next steps include lifting the algorithm from 2D to 3D and performing additional optimizations. Additionally, because the model is physically-based, we can add scene elements such as negative charges or electric fields, which would alter the behavior of lightning.
			<br><br>

                <div style="display: flex; flex-direction: column; align-items: center;">
                    <table style="width: 100%; text-align: center; border-collapse: collapse;">
                      <tr>
						<td width="25%">n = 1</td>
                        <td style="text-align: center;">
                          <img src="./images/1_1.png" width="90%"/>
                        </td>
                        <td style="text-align: center;">
                          <img src="./images/1_3.png" width="90%"/>
                        </td>
						<td style="text-align: center;">
							<img src="./images/1_5.png" width="90%"/>
						</td>
                      </tr>
					  <tr>
						<td width="25%">n = 3</td>
                        <td style="text-align: center;">
                          <img src="./images/3_1.png" width="90%"/>
                        </td>
                        <td style="text-align: center;">
                          <img src="./images/3_3.png" width="90%"/>
                        </td>
						<td style="text-align: center;">
							<img src="./images/3_5.png" width="90%"/>
						</td>
                      </tr>
					  <tr>
						<td width="25%">n = 5</td>
                        <td style="text-align: center;">
                          <img src="./images/5_1.png" width="90%"/>
                        </td>
                        <td style="text-align: center;">
                          <img src="./images/5_3.png" width="90%"/>
                        </td>
						<td style="text-align: center;">
							<img src="./images/5_5.png" width="90%"/>
						</td>
                      </tr>
                    </table>
                </div>

			<h4>Recursive space colonization</h4>
			
			Another path algorithm we implemented is based off a space colonization algorithm - originally designed as an algorithm for generating foliage and trees [ref] - introduced in the paper [ref]. While the algorithm is not rigidly grounded in physics, there are several compelling intuitive arguments for why space colonization is effective.
			(TODO: make to list)
			Space colonization is incredibly fast compared to physically-based models.
			Once the environment is initially configured, the actual path formation (assuming no branching) is entirely determinstic.
			Corona pulses and metastable accumulation in the model proposed by Locke [ref], operate more similarly to the space colonization attractor and kill model.
        </p>
		
		<h3>Simulation platform</h3>
		<p>
			<!-- &emsp;
			Our baseline plan is to replicate the implementation and result of Physically Based Animation and Rendering of Lightning by T. Kim and M. Lin which presented a physically based algorithm for the simulation, animation, and rendering of sustained electric arcs. 
			<br> -->

            <h4>Claire</h4>

            <h4>Shaders</h4>
            <p>
                &emsp;For rendering the lightning to look like a light source, we decided on using shaders to create a bloom effect since it will no longer be physically based. 
                <br>
                &emsp;In order to create the bloom effect, we decided to follow OpenGLâ€™s guide on creating the bloom effect using a high pass shader(to isolate the light emitting bodies), a gaussian blur shader(to create the light emitting effect) and a compositing shader that combines the base image of the scene with the blurred scene to create the final bloom effect. 
                <br>
                <br>
                &emsp;Currently, we have completed the high pass shader and the gaussian blur shader but in order to create the final image, we will need to modify the rendering pipeline in homework 4 to support running multiple shaders. 
                <br>
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <table style="width: 100%; text-align: center; border-collapse: collapse;">
                      <tr>
                        <td style="text-align: center;">
                          <img src="./images/highpass.png" width="90%"/>
                          <figcaption>A picture rendered with a high-pass shader</figcaption>
                        </td>
                        <td style="text-align: center;">
                          <img src="./images/gaussblur.png" width="95%"/>
                          <figcaption>A picture rentered with a Gaussian blur shader</figcaption>
                        </td>
                      </tr>
                    </table>
                </div>
            </p>
			<!-- However, we hope to extend this work as follows:
			<ul>
				<li>
					modeling physical effects specific to a Monte Carlo raytracer, which previous works do not originally use
				</li>
				<li>
					temporal simulation (ignoring or approximating relativistic effects)
				</li>
				<li>
					comparisons with more modern models for how lightning behaves, as the phenomenon is still poorly understood
				</li>
			</ul> -->
		</p>
		<h2>Schedule</h2>

        &emsp; Due to the changes in goals, we have fallen behind our original plan but we have also updated our plan to account for these changes.

		<h3>Week 2(4/13 - 4/19)</h3>
		<p>
            <ul>
				<li>
                    smth about paths
				</li>
                <li>
                    smth about paths
				</li>
				<li>
					claire
				</li>
				<li>
					Shaders: work on the rendering pipeline
				</li>
			</ul>
		
		</p>

		<h3>Week 3 (4/20 - 4/26)</h3>
		<p>
			<ul>
				<li>
                    smth about paths
				</li>
                <li>
                    smth about paths
				</li>
				<li>
					claire
				</li>
				<li>
					Shaders: continue work on the rendering pipeline and integrate with updated simulation platform
				</li>
			</ul>
        </p>

		<h3>Week 4 (4/27 - 5/3)</h3>
		<p>
			TODO
        </p>
    </body>
</html>